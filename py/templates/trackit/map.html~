<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15">
<title>Map</title>
  <style type="text/css" media="screen">
     #map { 
     background: #A1BDC4 ; 
     height: 100% ;  
     width: 100% ; 
     margin: 0px;

    }

     .popup-bnds { 
     margin: 10px; 
     padding: 10px;
     border: 1px solid #808080; 
     width: 200px; 
    } 
     .popup-content { 
     margin: 10px ; 
    }

  </style

</head>

<body>
    <script src="http://docs.opengeo.org/lib/openlayers/OpenLayers.js"></script>
    <script type="text/javascript">

     var popup ; 
     var map = null;
     function init(){

	    format = "image/png";
	    var bounds = new OpenLayers.Bounds(
			-180, -90,
			 180, 90
	     );

    var options = {
       maxExtent: bounds,
       projection: "EPSG:4326",
       units: 'degrees',
       numZoomLevels:20
    };


    map = new OpenLayers.Map('map',options);

    style= new OpenLayers.StyleMap({
	  externalGraphic: "/lib/img/sticky_thumb.png", 	  
	  pointRadius: 15,
	  cursor: "pointer"
	});        


       
    var trackit_issue = layer = new OpenLayers.Layer.WFS(
	      "reportit",
	      "http://docs.opengeo.org/geoserver/wfs",
	      {typename: 'topp:trackit_issue'},
	      {
	      featureNS: 'http://www.openplans.org/topp',
	      projection: new OpenLayers.Projection("EPSG:4326"),
	      extractAttributes: true,
	      ratio: 1.2,
        	      styleMap: style
							  
	      }
	   );
    map.addLayer(trackit_issue);

            var openstreetmap_gs = new OpenLayers.Layer.WMS(
                "OpenStreetMap",
                "http://demo.opengeo.org/geoserver_openstreetmap/gwc/service/wms",
                {
		    layers: "openstreetmap",
		    format: format,
		    bgcolor: '#A1BDC4'
		}
            )
       
      var popupControl = new OpenLayers.Control.SelectFeature(trackit_issue, {
	     onSelect: function(feature) {
	     var pos = feature.geometry;
	       if (popup) {
		   map.removePopup(popup);
			    }
		 popup = new OpenLayers.Popup.Anchored("popup-bnds",
			 new OpenLayers.LonLat(pos.x, pos.y),
			 new OpenLayers.Size(250,250),
			 "<div class='popup-content'> <p> "+ feature.attributes.date + "</p> <hr/> <p> " + feature.attributes.report + " </div>", 
		         null, 
			false
			 );
			map.addPopup(popup);       
			},
			onUnselect: function(feature) { 
			    map.removePopup(popup); 
			}

		    }); 
     
     map.addControl(popupControl);
     popupControl.activate();
     map.addLayer(openstreetmap_gs);
     map.setCenter( new OpenLayers.LonLat(-122.03,37.33),13);
        }
    </script>
</head>
  <body onload="init()">
<div id="map">
</body> </html>
